<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3"
      crossorigin="anonymous"
    />
    <link rel="shortcut icon" href="#" />

    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3-legend/2.25.6/d3-legend.min.js"></script>
    <script src="https://unpkg.com/@popperjs/core@2"></script>

    <script src="component/piechart.js"></script>
    <script src="component/barchart.js"></script>
    <script src="component/imagegrid.js"></script>

    <title>Celeberity visualize</title>
    <style>
      body {
        background: #eee;
        overflow-y: scroll;
      }

      .container {
        width: 2000px;
        background: white;
      }

      .brushed {
        stroke-width: 1;
        stroke: gray;
        r: 5;
      }
    </style>
  </head>

  <body>
    <header>
      <nav class="container navbar navbar-light bg-light">
        <div class="container-fluid">
          <span class="navbar-brand mb-0 h1">Celeberity Visualize</span>
        </div>
      </nav>
    </header>

    <main class="container pb-3">
      <div class="check box" id="checkboxes">
        <svg width="0" height="0" id="checkbox"></svg>
        <legend>특성을 선택해 주세요.</legend>
        <div class="form-check form-check-inline">
          <input
            class="form-check-input"
            type="checkbox"
            id="5_o_Clock_Shadow"
            value="5_o_Clock_Shadow"
          />
          <label class="form-check-label" for="5_o_Clock_Shadow"
            >5_o_Clock_Shadow</label
          >
        </div>
        <div class="form-check form-check-inline">
          <input
            class="form-check-input"
            type="checkbox"
            id="Arched_Eyebrows"
            value="Arched_Eyebrows"
          />
          <label class="form-check-label" for="Arched_Eyebrows"
            >Arched_Eyebrows</label
          >
        </div>
        <div class="form-check form-check-inline">
          <input
            class="form-check-input"
            type="checkbox"
            id="Attractive"
            value="Attractive"
          />
          <label class="form-check-label" for="Attractive">Attractive</label>
        </div>
        <div class="form-check form-check-inline">
          <input
            class="form-check-input"
            type="checkbox"
            id="Bags_Under_Eyes"
            value="Bags_Under_Eyes"
          />
          <label class="form-check-label" for="Bags_Under_Eyes"
            >Bags_Under_Eyes</label
          >
        </div>
        <div class="form-check form-check-inline">
          <input
            class="form-check-input"
            type="checkbox"
            id="Bald"
            value="Bald"
          />
          <label class="form-check-label" for="Bald">Bald</label>
        </div>
        <div class="form-check form-check-inline">
          <input
            class="form-check-input"
            type="checkbox"
            id="Bangs"
            value="Bangs"
          />
          <label class="form-check-label" for="Bangs">Bangs</label>
        </div>
        <div class="form-check form-check-inline">
          <input
            class="form-check-input"
            type="checkbox"
            id="Big_Lips"
            value="Big_Lips"
          />
          <label class="form-check-label" for="Big_Lips">Big_Lips</label>
        </div>
        <div class="form-check form-check-inline">
          <input
            class="form-check-input"
            type="checkbox"
            id="Big_Nose"
            value="Big_Nose"
          />
          <label class="form-check-label" for="Big_Nose">Big_Nose</label>
        </div>
        <div class="form-check form-check-inline">
          <input
            class="form-check-input"
            type="checkbox"
            id="Black_Hair"
            value="Black_Hair"
          />
          <label class="form-check-label" for="Black_Hair">Black_Hair</label>
        </div>
        <div class="form-check form-check-inline">
          <input
            class="form-check-input"
            type="checkbox"
            id="Blond_Hair"
            value="Blond_Hair"
          />
          <label class="form-check-label" for="Blond_Hair">Blond_Hair</label>
        </div>
        <div class="form-check form-check-inline">
          <input
            class="form-check-input"
            type="checkbox"
            id="Blurry"
            value="Blurry"
          />
          <label class="form-check-label" for="Blurry">Blurry</label>
        </div>
        <div class="form-check form-check-inline">
          <input
            class="form-check-input"
            type="checkbox"
            id="Brown_Hair"
            value="Brown_Hair"
          />
          <label class="form-check-label" for="Brown_Hair">Brown_Hair</label>
        </div>
        <div class="form-check form-check-inline">
          <input
            class="form-check-input"
            type="checkbox"
            id="Bushy_Eyebrows"
            value="Bushy_Eyebrows"
          />
          <label class="form-check-label" for="Bushy_Eyebrows"
            >Bushy_Eyebrows</label
          >
        </div>
        <div class="form-check form-check-inline">
          <input
            class="form-check-input"
            type="checkbox"
            id="Chubby"
            value="Chubby"
          />
          <label class="form-check-label" for="Chubby">Chubby</label>
        </div>
        <div class="form-check form-check-inline">
          <input
            class="form-check-input"
            type="checkbox"
            id="Double_Chin"
            value="Double_Chin"
          />
          <label class="form-check-label" for="Double_Chin">Double_Chin</label>
        </div>
        <div class="form-check form-check-inline">
          <input
            class="form-check-input"
            type="checkbox"
            id="Eyeglasses"
            value="Eyeglasses"
          />
          <label class="form-check-label" for="Eyeglasses">Eyeglasses</label>
        </div>
        <div class="form-check form-check-inline">
          <input
            class="form-check-input"
            type="checkbox"
            id="Goatee"
            value="Goatee"
          />
          <label class="form-check-label" for="Goatee">Goatee</label>
        </div>
        <div class="form-check form-check-inline">
          <input
            class="form-check-input"
            type="checkbox"
            id="Gray_Hair"
            value="Gray_Hair"
          />
          <label class="form-check-label" for="Gray_Hair">Gray_Hair</label>
        </div>
        <div class="form-check form-check-inline">
          <input
            class="form-check-input"
            type="checkbox"
            id="Heavy_Makeup"
            value="Heavy_Makeup"
          />
          <label class="form-check-label" for="Heavy_Makeup"
            >Heavy_Makeup</label
          >
        </div>
        <div class="form-check form-check-inline">
          <input
            class="form-check-input"
            type="checkbox"
            id="High_Cheekbones"
            value="High_Cheekbones"
          />
          <label class="form-check-label" for="High_Cheekbones"
            >High_Cheekbones</label
          >
        </div>
        <div class="form-check form-check-inline">
          <input
            class="form-check-input"
            type="checkbox"
            id="Male"
            value="Male"
            checked
          />
          <label class="form-check-label" for="Male">Male</label>
        </div>
        <div class="form-check form-check-inline">
          <input
            class="form-check-input"
            type="checkbox"
            id="Mouth_Slightly_Open"
            value="Mouth_Slightly_Open"
          />
          <label class="form-check-label" for="Mouth_Slightly_Open"
            >Mouth_Slightly_Open</label
          >
        </div>
        <div class="form-check form-check-inline">
          <input
            class="form-check-input"
            type="checkbox"
            id="Mustache"
            value="Mustache"
          />
          <label class="form-check-label" for="Mustache">Mustache</label>
        </div>
        <div class="form-check form-check-inline">
          <input
            class="form-check-input"
            type="checkbox"
            id="Narrow_Eyes"
            value="Narrow_Eyes"
          />
          <label class="form-check-label" for="Narrow_Eyes">Narrow_Eyes</label>
        </div>
        <div class="form-check form-check-inline">
          <input
            class="form-check-input"
            type="checkbox"
            id="No_Beard"
            value="No_Beard"
          />
          <label class="form-check-label" for="No_Beard">No_Beard</label>
        </div>
        <div class="form-check form-check-inline">
          <input
            class="form-check-input"
            type="checkbox"
            id="Oval_Face"
            value="Oval_Face"
          />
          <label class="form-check-label" for="Oval_Face">Oval_Face</label>
        </div>
        <div class="form-check form-check-inline">
          <input
            class="form-check-input"
            type="checkbox"
            id="Pale_Skin"
            value="Pale_Skin"
          />
          <label class="form-check-label" for="Pale_Skin">Pale_Skin</label>
        </div>
        <div class="form-check form-check-inline">
          <input
            class="form-check-input"
            type="checkbox"
            id="Pointy_Nose"
            value="Pointy_Nose"
          />
          <label class="form-check-label" for="Pointy_Nose">Pointy_Nose</label>
        </div>
        <div class="form-check form-check-inline">
          <input
            class="form-check-input"
            type="checkbox"
            id="Receding_Hairline"
            value="Receding_Hairline"
          />
          <label class="form-check-label" for="Receding_Hairline"
            >Receding_Hairline</label
          >
        </div>
        <div class="form-check form-check-inline">
          <input
            class="form-check-input"
            type="checkbox"
            id="Rosy_Cheeks"
            value="Rosy_Cheeks"
          />
          <label class="form-check-label" for="Rosy_Cheeks">Rosy_Cheeks</label>
        </div>
        <div class="form-check form-check-inline">
          <input
            class="form-check-input"
            type="checkbox"
            id="Sideburns"
            value="Sideburns"
          />
          <label class="form-check-label" for="Sideburns">Sideburns</label>
        </div>
        <div class="form-check form-check-inline">
          <input
            class="form-check-input"
            type="checkbox"
            id="Smiling"
            value="Smiling"
          />
          <label class="form-check-label" for="Smiling">Smiling</label>
        </div>
        <div class="form-check form-check-inline">
          <input
            class="form-check-input"
            type="checkbox"
            id="Straight_Hair"
            value="Straight_Hair"
          />
          <label class="form-check-label" for="Straight_Hair"
            >Straight_Hair</label
          >
        </div>
        <div class="form-check form-check-inline">
          <input
            class="form-check-input"
            type="checkbox"
            id="Wavy_Hair"
            value="Wavy_Hair"
          />
          <label class="form-check-label" for="Wavy_Hair">Wavy_Hair</label>
        </div>
        <div class="form-check form-check-inline">
          <input
            class="form-check-input"
            type="checkbox"
            id="Wearing_Earrings"
            value="Wearing_Earrings"
          />
          <label class="form-check-label" for="Wearing_Earrings"
            >Wearing_Earrings</label
          >
        </div>
        <div class="form-check form-check-inline">
          <input
            class="form-check-input"
            type="checkbox"
            id="Wearing_Hat"
            value="Wearing_Hat"
          />
          <label class="form-check-label" for="Wearing_Hat">Wearing_Hat</label>
        </div>
        <div class="form-check form-check-inline">
          <input
            class="form-check-input"
            type="checkbox"
            id="Wearing_Lipstick"
            value="Wearing_Lipstick"
          />
          <label class="form-check-label" for="Wearing_Lipstick"
            >Wearing_Lipstick</label
          >
        </div>
        <div class="form-check form-check-inline">
          <input
            class="form-check-input"
            type="checkbox"
            id="Wearing_Necklace"
            value="Wearing_Necklace"
          />
          <label class="form-check-label" for="Wearing_Necklace"
            >Wearing_Necklace</label
          >
        </div>
        <div class="form-check form-check-inline">
          <input
            class="form-check-input"
            type="checkbox"
            id="Wearing_Necktie"
            value="Wearing_Necktie"
          />
          <label class="form-check-label" for="Wearing_Necktie"
            >Wearing_Necktie</label
          >
        </div>
        <div class="form-check form-check-inline">
          <input
            class="form-check-input"
            type="checkbox"
            id="Young"
            value="Young"
            checked
          />
          <label class="form-check-label" for="Young">Young</label>
        </div>
      </div>

      <div class="dropdown pt-3" , id="dropdownmenu">
        <svg width="0" height="0" id="dropdown"></svg>
        <legend>인물을 선택해 주세요</legend>
        <div class="row">
          <div class="col-1"><strong>Celeb1:</strong></div>
          <div class="col-1"><select id="celeb1-dropdown"></select></div>
          <div class="col-1"><strong>Celeb2:</strong></div>
          <div class="col-1"><select id="celeb2-dropdown"></select></div>
        </div>
      </div>

      <div class="text-center">
        <legend>특성 간 상관관계</legend>
        <svg width="700" height="400" id="piechart"></svg>

        <div
          class="tooltip bs-tooltip-top show"
          id="pi-tooltip"
          role="tooltip"
          style="display: none"
        >
          <div class="tooltip-arrow"></div>
          <div class="tooltip-inner">Some tooltip text!</div>
        </div>
      </div>

      <div class="text-center">
        <legend>인물 간 특성 상관관계</legend>
        <svg width="1000" height="400" id="barchart"></svg>
        <div
          class="tooltip bs-tooltip-top show"
          id="br-tooltip"
          role="tooltip"
          style="display: none"
        >
          <div class="tooltip-arrow"></div>
          <div class="tooltip-inner">Some tooltip text!</div>
        </div>
      </div>

      <div class="text-center" style="margin: 10px">
        <legend>두 인물의 이미지 그리드</legend>
        <svg width="1000" height="300" id="imagegrid"></svg>
        <div
          class="tooltip bs-tooltip-top show"
          id="ig-tooltip"
          role="tooltip"
          style="display: none"
        >
          <div class="tooltip-arrow"></div>
          <div class="tooltip-inner">Some tooltip text!</div>
        </div>
      </div>
    </main>
    <script>
      let piechart, checkedCheckboxes, barchart, imagegrid;

      function updatePieChart() {
        piechart.update(checkedCheckboxes);
      }

      function updateBarchart(celeb1Value, celeb2Value) {
        barchart.update(celeb1Value, celeb2Value);
      }

      function updateImageGrid(celeb1Value, celeb2Value) {
        imagegrid.update(celeb1Value, celeb2Value);
      }

      d3.csv(
        "https://raw.githubusercontent.com/Lemma1727/visinfo/main/identity.csv"
      ).then(function (data) {
        var columns = data.columns;
        var excludedValues = ["Image", "name"];
        var filteredColumns = columns.filter(function (column) {
          return !excludedValues.includes(column);
        });

        var nameValues = new Set();
        data.forEach(function (d) {
          nameValues.add(d.name);
        });

        var nameArray = Array.from(nameValues);
        var celeb1Dropdown = d3.select("#celeb1-dropdown");
        celeb1Dropdown
          .selectAll("option")
          .data(nameArray)
          .enter()
          .append("option")
          .text(function (d) {
            return d;
          })
          .attr("value", function (d) {
            return d;
          });
        var celeb2Dropdown = d3.select("#celeb2-dropdown");
        celeb2Dropdown
          .selectAll("option")
          .data(nameArray)
          .enter()
          .append("option")
          .text(function (d) {
            return d;
          })
          .attr("value", function (d) {
            return d;
          });

        var celeb1Dropdown = document.getElementById("celeb1-dropdown");
        var celeb2Dropdown = document.getElementById("celeb2-dropdown");

        celeb1Dropdown.addEventListener("change", function () {
          var selectedCeleb1 = celeb1Dropdown.value;
          updateBarchart(selectedCeleb1, celeb2Dropdown.value);
          imagegrid.container1.selectAll("image").remove();
          updateImageGrid(selectedCeleb1, celeb2Dropdown.value);
        });

        celeb2Dropdown.addEventListener("change", function () {
          var selectedCeleb2 = celeb2Dropdown.value;
          updateBarchart(celeb1Dropdown.value, selectedCeleb2);
          imagegrid.container2.selectAll("image").remove();
          updateImageGrid(celeb1Dropdown.value, selectedCeleb2);
        });

        // 체크박스에 체크가 된 것들 확인
        var checkboxes = document.querySelectorAll(
          "#checkboxes input[type='checkbox']"
        );
        checkedCheckboxes = ["Young", "Male"];
        checkboxes.forEach(function (checkbox) {
          checkbox.addEventListener("change", function () {
            // Update the state of the checkbox
            if (checkbox.checked) {
              checkbox.setAttribute("data-checked", "true");
              checkedCheckboxes.push(checkbox.value);
            } else {
              var index = checkedCheckboxes.indexOf(checkbox.value);
              if (index !== -1) {
                checkedCheckboxes.splice(index, 1);
              }
            }
            updatePieChart();
          });
        });
        piechart = new PieChart(
          "#piechart",
          "#pi-tooltip",
          data,
          filteredColumns
        );
        piechart.initialize();
        updatePieChart();

        barchart = new BarChart(
          "#barchart",
          "#br-tooltip",
          data,
          filteredColumns
        );
        barchart.initialize();
        updateBarchart(celeb1Dropdown.value, celeb2Dropdown.value);

        imagegrid = new ImageGrid("#imagegrid", "#ig-tooltip", data);
        imagegrid.initialize();
        updateImageGrid(celeb1Dropdown.value, celeb2Dropdown.value);
      });
    </script>
  </body>
</html>
